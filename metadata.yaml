name: astrbot_plugin_context_aware
display_name: 上下文场景感知增强
desc: 增强 LLM 对群聊场景的理解能力，让 Bot 知道谁在和谁说话，可完全替代框架内置的群聊上下文感知功能
help: |
  ⚠️ 重要：安装本插件后，请关闭 AstrBot 内置的「群聊上下文感知(原聊天记忆增强)」功能！
  否则会导致 LLM 收到两份群聊记录，造成上下文膨胀。

  本插件通过分析群聊消息结构，为 LLM 提供结构化的场景描述，包括：
  - 触发类型：被@、被回复、唤醒词、主动搭话、戳一戳等
  - 对话对象：当前消息是对谁说的（关键功能）
  - 对话流：最近的对话结构和走向
  - Bot状态：上次发言时间
  - 图像转述：可选功能，将群友发送的图片转为文字描述

  v2.5.1 更新：
  - 新增公开 API：remove_message() 和 remove_last_bot_response()
  - 支持 recall_cancel 插件联动清理撤回消息的上下文记录

  v2.5.0 更新：
  - 新增戳一戳触发类型（TRIGGER_POKE）
  - 支持 poke_to_llm 插件的 _poke_trigger 标记
  - 戳一戳时正确显示戳一戳用户信息

  v2.4.0 更新：
  - 新增图像转述功能，可将群友发送的图片转为文字描述
  - 支持下拉选择图像转述提供商
  - 完善文档，明确说明需关闭框架内置 LTM

  v2.3.0 更新：
  - 修复回复词推断误判
  - 增加 Bot 回复对象追踪
  - 优化 TRIGGER_UNKNOWN 处理

  特点：
  - 可完全替代框架内置 LTM 的群聊记录功能
  - 只做加法，不修改框架原有信息
  - 轻量快速，图像转述为可选功能

  配置说明请查看插件配置页面。
version: 2.5.1
author: 木有知
repo: https://github.com/muyouzhi6/astrbot_plugin_context_aware
